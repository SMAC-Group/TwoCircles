<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two-sample Tests for Circular Data • TwoCircles</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Two-sample Tests for Circular Data">
<meta property="og:description" content="Exact Distributions and Performance of some Two-sample Nonparametric Tests for Circular Data">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">TwoCircles</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SMAC-Group/simts">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<div id="twocircles-overview" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#twocircles-overview" class="anchor"></a><code>TwoCircles</code> Overview</h1></div>
<p>This package implements various nonparametric methods for testing whether two circular samples come from the same population and allows to obtain its associated small-sample distribution. In particular, the following test are considered:</p>
<ul>
<li>
<code>dixon</code>: for Dixon test,</li>
<li>
<code>rao</code>: for Rao test,</li>
<li>
<code>wilcox</code>: for Wilcoxon test,</li>
<li>
<code>ww</code> for Wheeler-Watson test.</li>
</ul>
<p>The code below presents a simple example with the pigeons dataset of Schmidt-Koenig (1958).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load dataset</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">data</span>(pigeons)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Dixon test (exact pvalue)</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(pigeons<span class="op">$</span>experimental, pigeons<span class="op">$</span>control)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;       Dixon Two Sample Test</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; Data:  pigeons$experimental and pigeons$control</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Test Statistic: 41</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; Exact P-value: 0.02096</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; Bracketing Points and Pair of Signif. Levels:</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; c1 = 33 (p1 = 0.0567)</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; c2 = 35 (p2 = 0.0460)</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># Dixon test (approximated pvalue)</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(pigeons<span class="op">$</span>experimental, pigeons<span class="op">$</span>control, <span class="dt">type =</span> <span class="st">"mc"</span>)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;       Dixon Two Sample Test</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; Data:  pigeons$experimental and pigeons$control</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; Test Statistic: 41</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; Approx. P-value: 0.0228</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; P-value stand. error: 0.0009575</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; based on 10000 Monte-Carlo replications</span></a></code></pre></div>
<p>It is also possible to compare the exact distribution of the test statistic under <span class="math inline">\(H_0\)</span> to the one obtained by simulations. This can be done as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">plot</span>(<span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(pigeons<span class="op">$</span>experimental, pigeons<span class="op">$</span>control), <span class="dt">cex.main =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(pigeons<span class="op">$</span>experimental, pigeons<span class="op">$</span>control, <span class="dt">type =</span> <span class="st">"mc"</span>, <span class="dt">B =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">3</span>), <span class="dt">cex.main =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The simulation-based approach is proposed here as an alternative to reduce the computational burden of then method when the samples are too large to allow for the calculation of the exact sampling distribution through exhaustive enumeration of all possible combinations. When the number of Monte-Carlo replication is relatively large (say around <span class="math inline">\(10^3\)</span> or more) the results with the exact and approximated method are very close. In addition, this method also provides an estimate of the standard error associated to the obtained p-value, which is computed by nonparametric bootstrap. The precision of the simulation-based approach is illustrated in the simple simulation presented below where we compared the p-values obtained with the exact and simulation-based method.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Number of simulations</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">B =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># Initialisation</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">exact_pval =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">mc_pval =<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, B, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B){</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="co"># Simulate samples</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  X =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">360</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  Y =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">360</span>)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  <span class="co"># Compute exact pvalue</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  exact_results =<span class="st"> </span><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(X, Y)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  exact_pval[i] =<span class="st"> </span><span class="kw">mean</span>(exact_results<span class="op">$</span>stat <span class="op">&lt;=</span><span class="st"> </span>exact_results<span class="op">$</span>cv<span class="op">$</span>dist)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  <span class="co"># Compute MC pvalue</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  mc_results =<span class="st"> </span><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(X, Y, <span class="dt">type =</span> <span class="st">"mc"</span>, <span class="dt">B =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  mc_pval[i,<span class="dv">1</span>] =<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(mc_results<span class="op">$</span>stat <span class="op">&lt;=</span><span class="st"> </span>mc_results<span class="op">$</span>mc<span class="op">$</span>dist))<span class="op">/</span>(<span class="kw">length</span>(mc_results<span class="op">$</span>mc<span class="op">$</span>dist) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  mc_results =<span class="st"> </span><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(X, Y, <span class="dt">type =</span> <span class="st">"mc"</span>, <span class="dt">B =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">  mc_pval[i,<span class="dv">2</span>] =<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(mc_results<span class="op">$</span>stat <span class="op">&lt;=</span><span class="st"> </span>mc_results<span class="op">$</span>mc<span class="op">$</span>dist))<span class="op">/</span>(<span class="kw">length</span>(mc_results<span class="op">$</span>mc<span class="op">$</span>dist) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">  mc_results =<span class="st"> </span><span class="kw"><a href="reference/circular_test.html">circular_test</a></span>(X, Y, <span class="dt">type =</span> <span class="st">"mc"</span>, <span class="dt">B =</span> <span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  mc_pval[i,<span class="dv">3</span>] =<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(mc_results<span class="op">$</span>stat <span class="op">&lt;=</span><span class="st"> </span>mc_results<span class="op">$</span>mc<span class="op">$</span>dist))<span class="op">/</span>(<span class="kw">length</span>(mc_results<span class="op">$</span>mc<span class="op">$</span>dist) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">}</a></code></pre></div>
<p>The difference between the p-values obtained from the two methods are presented in the histograms below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">hist</span>(<span class="dv">100</span><span class="op">*</span>(exact_pval<span class="op">-</span>mc_pval[,<span class="dv">1</span>]), <span class="dt">col =</span> <span class="st">"lightgrey"</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">"Exact p-value - MC p-value (%)"</span>, <span class="dt">main =</span> <span class="st">"B = 1,000"</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">hist</span>(<span class="dv">100</span><span class="op">*</span>(exact_pval<span class="op">-</span>mc_pval[,<span class="dv">2</span>]), <span class="dt">col =</span> <span class="st">"lightgrey"</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">"Exact p-value - MC p-value (%)"</span>, <span class="dt">main =</span> <span class="st">"B = 10,000"</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">hist</span>(<span class="dv">100</span><span class="op">*</span>(exact_pval<span class="op">-</span>mc_pval[,<span class="dv">3</span>]), <span class="dt">col =</span> <span class="st">"lightgrey"</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">"Exact p-value - MC p-value (%)"</span>, <span class="dt">main =</span> <span class="st">"B = 100,000"</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<div id="install-instructions" class="section level2">
<h2 class="hasAnchor">
<a href="#install-instructions" class="anchor"></a>Install Instructions</h2>
<p>To install the <code>TwoCircles</code> package, there is currently one option: <a href="https://github.com/SMAC-Group/TwoCircles/">GitHub</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Install dependencies</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">"gRbase"</span>, <span class="st">"circular"</span>, <span class="st">"devtools"</span>))</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Install the package from GitHub</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"SMAC-Group/TwoCircles"</span>)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/SMAC-Group/TwoCircles">https://​github.com/​SMAC-Group/​TwoCircles</a>
</li>
<li>Report a bug at <br><a href="https://github.com/SMAC-Group/TwoCircles/issues">https://​github.com/​SMAC-Group/​TwoCircles/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Stephane Guerrier <br><small class="roles"> Author, maintainer </small>  </li>
<li>S. Rao Jammalamadaka <br><small class="roles"> Author </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/SMAC-Group/TwoCircles"><img src="https://travis-ci.org/SMAC-Group/TwoCircles.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/licence-CC%20BY--NC--SA%204.0-blue.svg" alt="Licence"></a></li>
<li><a href="https://cran.r-project.org/"><img src="https://img.shields.io/badge/R%3E%3D-3.4.0-6666ff.svg" alt="minimal R version"></a></li>
<li><a href="https://cran.r-project.org/package=TwoCircles"><img src="http://www.r-pkg.org/badges/version/TwoCircles" alt="CRAN"></a></li>
<li><a href="commits/develop"><img src="https://img.shields.io/badge/Package%20version-0.1.0-orange.svg?style=flat-square" alt="packageversion"></a></li>
<li><a href="/commits/master"><img src="https://img.shields.io/badge/last%20change-2018--11--24-yellowgreen.svg" alt="Last-changedate"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Stephane Guerrier, S. Rao Jammalamadaka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
